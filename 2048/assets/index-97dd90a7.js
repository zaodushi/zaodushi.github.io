var v=Object.defineProperty;var I=(l,r,a)=>r in l?v(l,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[r]=a;var d=(l,r,a)=>(I(l,typeof r!="symbol"?r+"":r,a),a);(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function a(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerpolicy&&(o.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?o.credentials="include":e.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(e){if(e.ep)return;e.ep=!0;const o=a(e);fetch(e.href,o)}})();class k{constructor(r,a){d(this,"row");d(this,"col");d(this,"id");d(this,"el");d(this,"merged");this.row=r,this.col=a,this.id=this.row*4+this.col,this.el=document.getElementById(this.id.toString()),this.val=0,this.merged=!1}get val(){return this.el.innerHTML===""?0:parseInt(this.el.innerHTML)}set val(r){this.el.innerHTML=r===0?"":r.toString(),this.el.className=`unit-${r}`}modify(r,a="generate"){this.val=r,this.el.style.animation=`${a} 0.2s`,setTimeout(()=>{this.el.style.animation=""},200)}}const y=()=>{let l=new Array(4);for(let r=0;r<4;r++){l[r]=new Array(4);for(let a=0;a<4;a++)l[r][a]=new k(r,a)}return l};let i;const c={deBounce:!1,restartCount:0,win:!1,lost:!1},b=document.getElementById("score"),h=()=>{i=y(),c.win=c.lost=!1,c.restartCount++>0?(f(),f()):setTimeout(()=>{f(),f()},1e3)},p=(l,r)=>parseInt((Math.random()*(r-l+1)).toString()),x=l=>{const r=p(0,l.length-1);let{row:a,col:n}=l[r];i[a][n].modify(2)},f=()=>{c.deBounce=!0;let l=-4,r=[];for(const a in i)for(const n in i[a]){const e=i[a][n].val;l+=e,e===2048&&c.win===!1&&(alert("Congratulations! You win!"),c.win=!0),e===0&&r.push({row:parseInt(a),col:parseInt(n)})}b.innerHTML=Math.max(l,0).toString(),r.length===0||x(r),setTimeout(()=>{c.deBounce=!1},200)},B=()=>{document.getElementById("restart").addEventListener("click",h)},u={up:()=>{if(c.deBounce)return;let l=!1;const r=(n,e)=>{const o=i[n][e];if(o.merged=!1,o.val!==0)for(let s=n-1;s>=0;s--){const t=i[s][e];if(t.val!==0)if(o.val===t.val&&!t.merged)t.modify(t.val*2,"bounceIn"),t.merged=!0,o.val=0,l=!0;else return}},a=(n,e)=>{const o=i[n][e];let s=-1;if(o.val!==0){for(let t=n-1;t>=0&&i[t][e].val===0;t--)s=t;s!=-1&&(i[s][e].modify(o.val,"slideInUp"),o.val=0,l=!0)}};for(let n=0;n<4;n++)for(let e=0;e<4;e++)r(e,n),a(e,n);l&&f()},down:()=>{if(c.deBounce)return;let l=!1;const r=(n,e)=>{const o=i[n][e];if(o.merged=!1,o.val!==0)for(let s=n+1;s<4;s++){const t=i[s][e];if(t.val!==0)if(o.val===t.val&&!t.merged)t.modify(t.val*2,"bounceIn"),t.merged=!0,o.val=0,l=!0;else return}},a=(n,e)=>{const o=i[n][e];let s=-1;if(o.val!==0){for(let t=n+1;t<4&&i[t][e].val===0;t++)s=t;s!=-1&&(i[s][e].modify(o.val,"slideInDown"),o.val=0,l=!0)}};for(let n=0;n<4;n++)for(let e=3;e>=0;e--)r(e,n),a(e,n);l&&f()},left:()=>{if(c.deBounce)return;let l=!1;const r=(n,e)=>{const o=i[n][e];if(o.merged=!1,o.val!==0)for(let s=e-1;s>=0;s--){const t=i[n][s];if(t.val!==0)if(o.val===t.val&&!t.merged)t.modify(t.val*2,"bounceIn"),t.merged=!0,o.val=0,l=!0;else return}},a=(n,e)=>{const o=i[n][e];let s=-1;if(o.val!==0){for(let t=e-1;t>=0&&i[n][t].val===0;t--)s=t;s!=-1&&(i[n][s].modify(o.val,"slideInRight"),o.val=0,l=!0)}};for(const n in i)for(const e in i[n])r(parseInt(n),parseInt(e)),a(parseInt(n),parseInt(e));l&&f()},right:()=>{if(c.deBounce)return;let l=!1;const r=(n,e)=>{const o=i[n][e];if(o.merged=!1,o.val!==0)for(let s=e+1;s<4;s++){const t=i[n][s];if(t.val!==0)if(o.val===t.val&&!t.merged)t.modify(t.val*2,"bounceIn"),t.merged=!0,o.val=0,l=!0;else return}},a=(n,e)=>{const o=i[n][e];let s=-1;if(o.val!==0){for(let t=e+1;t<4&&i[n][t].val===0;t++)s=t;s!=-1&&(i[n][s].modify(o.val,"slideInLeft"),o.val=0,l=!0)}};for(const n in i)for(let e=3;e>=0;e--)r(parseInt(n),e),a(parseInt(n),e);l&&f()}},w=l=>{switch(l.code){case"ArrowLeft":u.left();break;case"ArrowUp":u.up();break;case"ArrowRight":u.right();break;case"ArrowDown":u.down();break}},g={x:0,y:0};function L(l){g.x=l.touches[0].clientX,g.y=l.touches[0].clientY}function M(l){const r=l.changedTouches[0].clientX-g.x,a=l.changedTouches[0].clientY-g.y;if(Math.abs(r)>Math.abs(a)){if(Math.abs(r)<100)return;r>0?u.right():u.left()}else{if(Math.abs(a)<100)return;a>0?u.down():u.up()}}const T=()=>{document.addEventListener("keydown",w),document.addEventListener("touchstart",L),document.addEventListener("touchend",M)};B();T();h();
